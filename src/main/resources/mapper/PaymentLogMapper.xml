<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.smm.payCenter.dao.PaymentLogDao" >
  <resultMap id="BaseResultMap" type="com.smm.payCenter.domain.PaymentLog" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Mon Nov 23 11:25:53 CST 2015.
    -->
    <id column="id" property="id" jdbcType="INTEGER" />
    <result column="payment_id" property="paymentId" jdbcType="INTEGER" />
    <result column="operation_name" property="operationName" jdbcType="VARCHAR" />
    <result column="operation_time" property="operationTime" jdbcType="VARCHAR" />
    <result column="operation_result" property="operationResult" jdbcType="VARCHAR" />
    <result column="opetation_desc" property="desc" jdbcType="VARCHAR" />
    <result column="create_time" property="createTime" jdbcType="VARCHAR" />
    
    <result column="payment_no" property="paymentNo" jdbcType="VARCHAR" />
  </resultMap>
  <select id="queryPaymentLogData" parameterType="java.util.Map" resultMap="BaseResultMap">
  	
  	SELECT pl.*,pay.payment_no FROM  s_payment_log pl,tr_payment_record pay 
  	
  	WHERE pl.payment_id = pay.payment_id 
  	
  	<if test="paymentId != null">
  		AND pay.payment_no = '${paymentId}'
  	</if>
  
  	ORDER BY id ASC
	
	<!-- 分页 -->
	<if test="startNum!=null and endNum !=null ">
		limit ${startNum},${endNum}
	</if>
  </select>
  
  <select id="queryPaymentLogCount" parameterType="java.util.Map" resultType="Integer">
  	
  	SELECT count(1) from
  	
  	(
  		SELECT pl.*,pay.payment_no as paymentNo FROM  s_payment_log pl,tr_payment_record pay 
  	
  		WHERE pl.payment_id = pay.payment_id 
  	
	 
  		<if test="paymentId != null">
  			AND pay.payment_no = '${paymentId}'
  		</if>
	  
	  	ORDER BY id ASC
	  	
  	) temp
  	
  </select>
  
</mapper>